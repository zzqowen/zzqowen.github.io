<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <style>
        img, div{
            width: 100px;
            height: 100px;
            display: block;
        }
        .div{
            background: url("http://www.bing.com/az/hprichbg/rb/UrbinoRooftops_ZH-CN9076169426_1920x1080.jpg");
        }
    </style>
</head>
<body>
<img src="" alt="" id="img">
<img src="" alt="" id="img1">
<div id="div"></div>
<a href=""></a>
<img src="" alt="" id="conImg">

</body>
<script src="js/compressPictures.js"></script>
<script>
    var imgArr = [
        "http://www.bing.com/az/hprichbg/rb/UrbinoRooftops_ZH-CN9076169426_1920x1080.jpg"
    ];

    var data = pictures.compress("../images/beauty1.jpg", 50, "png", function(data){
        document.getElementById("conImg").setAttribute("src", data);

        pictures.save(data);
    });

    var img = document.getElementById("img");
    var img1 = document.getElementById("img1");
    var div = document.getElementById("div");

    img.style.display = "none";
    img1.style.display = "none";
    div.style.display = "none";

    var a = 0, b = imgArr.length;

    function SImage(url, callback){
        var img = new Image();
        img.src = url;
        if (img.complete){
            a ++;
            console.log("complete");
            callback(a);
            return
        }
        img.onload = function(){
            a ++;
            console.log("onload");
            callback(a);
        };
    }

    function iCall(v){
        console.log(v);
        if (v<b){
            SImage(imgArr[v], iCall);
        }else if (v >= b){
            a = 0;
            start();
        }
    }

    iCall(a);
    function start(){
        console.log("开始");
        img.src = imgArr[0];
        img.style.display = "block";
        setTimeout(function(){
            img1.src = imgArr[0];
            img.style.display = "none";
            img1.style.display = "block";
            setTimeout(function(){
                img1.style.display = "none";
                div.style.display = "block";
                div.className = "div";
//                div.style.background = "url('"+ imgArr[0] +"') no-repeat center center"
            }, 2000);
        }, 2000);

    }
</script>
</html>