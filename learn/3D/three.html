<!DOCTYPE html>
<html lang="zh-cn">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <script src='./js/stats.min.js'></script>
  <script src="./js/three.min.js"></script>
  <script src="./js/tween.umd.js"></script>
  <script src="js/RequestAnimationFrame.js"></script>
  <script src="js/TrackballControls.js"></script>
  <script src="js/DDSLoader.js"></script>
  <script src="js/OBJLoader.js"></script>
  <script src="js/OBJMTLLoader.js"></script>
  <script>
    // (function(){var script=document.createElement('script');script.onload=function(){var stats=new Stats();document.body.appendChild(stats.dom);requestAnimationFrame(function loop(){stats.update();requestAnimationFrame(loop)});};script.src='//mrdoob.github.io/stats.js/build/stats.min.js';document.head.appendChild(script);})()
  </script>
  <style>
    html,
    body {
      height: 100%;
      width: 100%;
    }

    div#canvas-frame {
      border: 0 none;
      cursor: pointer;
      width: 100%;
      height: 100%;
      background-color: #fefefe;
    }

    #percent {
      position: absolute;
      width: 200px;
      height: 20px;
      color: red;
      text-align: center;
      border: 1p;
      right: 0;
      top: 20px;
    }
  </style>
</head>

<body onload="load()">
  <div id="percent"></div>

  <div id="canvas-frame"></div>
  <script>
    var canvasFrame = document.getElementById('canvas-frame');
    var width = canvasFrame.clientWidth;
    var height = canvasFrame.clientHeight;
    var renderer;

    function initThree() {
      renderer = new THREE.WebGLRenderer();
      renderer.setSize(width, height);
      canvasFrame.appendChild(renderer.domElement);
      renderer.setClearColor(0xf3f3f3, 1);
      renderer.shadowMapEnabled = true; //激活阴影
    }

    var scene;

    function initScene() {
      scene = new THREE.Scene();
    }

    var camera;

    function initCamera() {
      camera = new THREE.PerspectiveCamera(45, width / height, 1, 10000);
      // camera = new THREE.OrthographicCamera(width / -2, width / 2, height / 2 , height / -2, 1, 10000);
      camera.position.x = 100;
      camera.position.y = 100;
      camera.position.z = 600;
      camera.up.x = 0;
      camera.up.y = 1;
      camera.up.z = 0;

      trackballControlsInit()
    }

    var light;

    function initLight() {
      // light = new THREE.AmbientLight(0xffffff);
      // // light = new THREE.DirectionalLight (0xFFFFFF, 1.0, 0);
      // light.position.set(100, 100, 200);
      // scene.add(light);
      // light.position.set(100, 100, 200);
      // scene.add(light);

      var spotLight = new THREE.SpotLight(0xffffff);
				spotLight.position.set(-10,200,10);
				spotLight.castShadow = true;
				scene.add(spotLight);
    }

    var mesh;

    function initObject() {
      // // var geometry = new THREE.CubeGeometry( 200, 100, 50,4,4);
      // var geometry = new THREE.BoxGeometry(100, 100, 100);
      // console.log(geometry.faces)
      // for (let i = 0; i < geometry.faces.length; i += 2) {
      //   var hex = Math.random() * 0xffffff;
      //   // console.log(geometry.faces[i].color)
      //   geometry.faces[i].color.setHex(hex)
      //   geometry.faces[i + 1].color.setHex(hex)

      // }

      // var material = new THREE.MeshBasicMaterial({
      //   vertexColors: THREE.FaceColors
      // })
      // mesh = new THREE.Mesh(geometry, material)
      // mesh.position = new THREE.Vector3(0, 30, 0)

      // // var geometry = new THREE.PlaneGeometry(300, 300, 1, 1);

      // // geometry.vertices[0].uv = new THREE.Vector2(0,0);
      // // geometry.vertices[1].uv = new THREE.Vector2(1,0);
      // // geometry.vertices[2].uv = new THREE.Vector2(1,1);
      // // geometry.vertices[3].uv = new THREE.Vector2(0,1);
      // // var texture = new THREE.ImageUtils.loadTexture('img/1.jpg', null, function() {

      // // });
      // // texture.needsUpdate = true;
      // // var material = new THREE.MeshBasicMaterial({map: texture, color: 0xFFFFFF});
      // scene.add(mesh);


      // model
      // var onProgress = function (xhr) {
      //   if (xhr.lengthComputable) {
      //     var percentComplete = xhr.loaded / xhr.total * 100;
      //     var percent = document.getElementById("percent");
      //     percent.innerText = Math.round(percentComplete, 2) + '% 已经加载';
      //   }
      // };
      // var onError = function (xhr) {};
      // var mtlLoader = new THREE.MTLLoader();
      // mtlLoader.setPath('model/');
      // mtlLoader.load('file.mtl', function (materials) {

      //   materials.preload();

      //   var objLoader = new THREE.OBJLoader();
      //   objLoader.setMaterials(materials);
      //   objLoader.setPath('model/');
      //   objLoader.load('file.obj', function (object) {

      //     object.position.y = 0;
      //     object.rotation.y = 0.5;
      //     object.scale.set(0.2, 0.2, 0.2);
      //     scene.add(object);

      //   }, onProgress, onError);
      // });
    }

    function trackballControlsInit() {
      //创建控件并绑定在相机上
      trackballControls = new THREE.TrackballControls(camera);
      trackballControls.rotateSpeed = 1.0;
      trackballControls.zoomSpeed = 1.0;
      trackballControls.panSpeed = 1.0;
      trackballControls.noZoom = false;
      trackballControls.noPan = false;
      trackballControls.staticMoving = true;
      trackballControls.dynamicDampingFactor = 0.3;
    }

    function initGrid() {
      var axes = new THREE.AxisHelper(20);
      scene.add(axes);
      var helper = new THREE.GridHelper(1000, 100);
      helper.setColors(0xff0000, 0xff0000);
      scene.add(helper);
    }

    function load() {
      initThree();
      initCamera();
      initScene();
      initGrid();
      initLight();
      initObject();
      // new TWEEN.Tween(mesh.rotation)
      //   .to({
      //     y: 30
      //   }, 3000).repeat(Infinity).start();
      animate()

    }

    var stats = new Stats();
    document.body.appendChild(stats.dom);

    function animate() {

      var clock = new THREE.Clock();
      var delta = clock.getDelta();
      trackballControls.update(delta);
      // mesh.rotation.y += -0.1;
      renderer.clear();
      renderer.render(scene, camera);

      requestAnimationFrame(animate)
      stats.update();
      // TWEEN.update();

    };
  </script>
</body>

</html>